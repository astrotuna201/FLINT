<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLINT: FLINT: Fortran Library for numerical INTegrators of differential equations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLINT
   &#160;<span id="projectnumber">0.9.1</span>
   </div>
   <div id="projectbrief">Fortran Library for numerical INTegration of differential equations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">FLINT: Fortran Library for numerical INTegrators of differential equations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A fortran library for numerical integration with dense output and multiple event-detection support. Currently, it provides four Explicit Runge-Kutta methods: DOP54, DOP853, Verner65E, and Verner98R. </p><dl class="section author"><dt>Author</dt><dd>Bharat Mahajan </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.9.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>01/25/2019</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2019 Bharat Mahajan <br />
<br />
 This work was performed at Odyssey Space Research LLC, Houston, TX as part of the work under contract no. 80JSC017D0001 with NASA-Johnson Space Center. FLINT source code is licensed under the Apache License, Version 2.0 (the "License") found in LICENSE file contained in this distribution. <br />
<br />
 The coefficients for DOP853 method were derived by Ernest Hairer. His original codes are available at <a href="http://www.unige.ch/~hairer/software.html">http://www.unige.ch/~hairer/software.html</a>. The coefficients for Verner65E and Verner98R methods were derived by Jim Verner, and are available at <a href="http://people.math.sfu.ca/~jverner/">http://people.math.sfu.ca/~jverner/</a>.</dd></dl>
<h1><a class="anchor" id="sec"></a>
Introduction</h1>
<p>FLINT is a modern object-oriented fortran library that provides four adaptive step-size explicit Runge-Kutta (ERK) methods of order 5, 6, 8, and 9 along with dense-output and event-detection support for each of the methods. The code is written such that any other ERK method can be implemented by including its coefficients with minimum changes required in the code. The DOP853 integrator is the default method chosen, and its implementation is hand-optimized specific to its coefficients. For other integrators, a generic routine for step-integration is implemented. This generic routine supports both FSAL and non-FSAL methods. Dense output is supported with delayed interpolation. When interpolation is enabled, FLINT computes the interpolation coefficients during the integration and stores them in internal memory. After that, the interpolation method can be used any number of times to find the solution values at any user-specified grid within the initial and final points used during the integration. Interpolation is much faster than integration in FLINT, as the coefficients are all precomputed during integration. Multiple event detection is (static and dynamic) supported for each integrator along with event-masking, event-direction and termination options. Additionally, a step-size for event detection is also supported. In a nutshell, the features are:</p>
<ul>
<li>Modern object-oriented, thread-safe, and optimized Fortran code</li>
<li>4 Explicit Runge-Kutta (ERK) integrators: DOP54, DOP853, Verner98R, Verner65E</li>
<li>Any ERK method can be implemented by just including their coefficients</li>
<li>Dense output with delayed interpolation (integrate once, interpolate as many times)</li>
<li>Multiple event-detection with event masking and separate event step-size</li>
<li>Stiffness detection</li>
</ul>
<p>User specifies the differential equations and events function in a separate class and their interfaces are provided. See the test program TestFLINT and the DiffEq module on how to use FLINT. This library was compiled with Intel Fortran compiler from Intel Parallel Studio XE Composer for Windows 2016 integrated with Microsoft Visual Studio Community version 2017. The visual studio solution file is provided. The code should compile on gfortran with no issues, however it is not tested with it (yet). FLINT has no dependency on any other library.</p>
<h1><a class="anchor" id="usagesec"></a>
Usage</h1>
<ul>
<li>Create a differential equation system class by providing differential equation function, events function (if any), and parameters (if any).</li>
</ul>
<div class="fragment"><div class="line"><span class="keywordtype">use </span><a class="code" href="namespaceflint.html">flint</a></div><div class="line"><span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line"><span class="keyword">type</span>, <span class="keyword">extends</span>(diffeqsys) :: tbsys</div><div class="line"><span class="keywordtype">    real</span>(WP) :: GM = 398600.436233_wp  <span class="comment">! parameter constant</span></div><div class="line"><span class="keyword">contains</span></div><div class="line">    <span class="keywordtype">procedure</span> :: F =&gt; twobodyde     <span class="comment">! Differential equations</span></div><div class="line">    <span class="keywordtype">procedure</span> :: G =&gt; sampleeventtb <span class="comment">! events, use only if needed</span></div><div class="line"><span class="keyword">end type </span>tbsys</div><div class="line"></div><div class="line"><span class="keyword">contains</span></div><div class="line"></div><div class="line"><span class="keywordtype">pure</span> <span class="keyword">function </span>twobodyde(me, X, Y, Params)</div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line">    <span class="keywordtype">class</span>(TBSys), <span class="keywordtype">intent(in)</span> :: me</div><div class="line"><span class="keywordtype">    real</span>(WP), <span class="keywordtype">intent(in)</span> :: X</div><div class="line"><span class="keywordtype">    real</span>(WP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: Y</div><div class="line"><span class="keywordtype">    real</span>(WP), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span> :: Params</div><div class="line"><span class="keywordtype">    real</span>(WP), <span class="keywordtype">dimension(size(Y))</span> :: TwoBodyDE</div><div class="line"></div><div class="line">    twobodyde(1:3) = y(4:6)</div><div class="line">    twobodyde(4:6) = -me%GM/(norm2(y(1:3))**3)*y(1:3) <span class="comment">! Two-body orbit diffeq</span></div><div class="line"><span class="keyword">end function </span>twobodyde</div><div class="line"></div><div class="line"><span class="keywordtype">pure</span> <span class="keyword">subroutine </span>sampleeventtb(me, EventID, X, Y, Value, Direction, Terminal)</div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line">    <span class="keywordtype">class</span>(TBSys), <span class="keywordtype">intent(in)</span> :: me</div><div class="line">    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: EventID        </div><div class="line"><span class="keywordtype">    real</span>(WP), <span class="keywordtype">intent(in)</span> :: X</div><div class="line"><span class="keywordtype">    real</span>(WP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: Y</div><div class="line"><span class="keywordtype">    real</span>(WP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(out)</span> :: Value</div><div class="line">    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(size(Value))</span>, <span class="keywordtype">intent(out)</span> :: Direction</div><div class="line">    <span class="keywordtype">logical</span>, <span class="keywordtype">dimension(size(Value))</span>, <span class="keywordtype">intent(out)</span> :: Terminal</div><div class="line"></div><div class="line">    value(1) = y(2) <span class="comment">! detect y-crossing</span></div><div class="line">    value(2) = y(1) <span class="comment">! detect x-crossing    </span></div><div class="line"></div><div class="line">    direction(1) = 1  <span class="comment">! detect -ve to +ve transitions for y coordinate</span></div><div class="line">    direction(2) = -1 <span class="comment">! detect +ve to -ve transitions for x coordinate</span></div><div class="line">    terminal = [.false., .false.] <span class="comment">! continue integration after events</span></div><div class="line"><span class="keyword">end subroutine </span>SampleEventTB      </div></div><!-- fragment --><ul>
<li>Create and initialize the differential equation and ERK class objects for using Runge-Kutta intgerators</li>
</ul>
<div class="fragment"><div class="line"><span class="keywordtype">use </span><a class="code" href="namespaceflint.html">flint</a></div><div class="line"><span class="keywordtype">type</span>(ERK_class) ::  erk</div><div class="line"><span class="keywordtype">type</span>(TBSys)     :: diffeq</div><div class="line">diffeq%n = 6        <span class="comment">! Number of 1st-order differential equations</span></div><div class="line">diffeq%m = 2        <span class="comment">! Number of events</span></div><div class="line"></div><div class="line"><span class="comment">! Initialize the ERK object for 10000 max steps, DOP54 method with abs. tol. 1e-12, rel. tol. 1e-9</span></div><div class="line"><span class="comment">! and turn on interpolation and events detection    </span></div><div class="line"><span class="keyword">call </span><a class="code" href="namespaceerk.html">erk</a>%Init(diffeq, 10000, method=erk_dop54, atol=[1e-12], rtol=[1e-9],&amp;</div><div class="line">interpon=.true.,eventson=.true.)</div></div><!-- fragment --><ul>
<li>Call the Integrate subroutine for performing the integration if init was successful. Note if interpolation is enabled, then the IntStepsOn option for computing the states at the integrator's natural step-size must not be set to True.</li>
</ul>
<div class="fragment"><div class="line"><span class="keywordtype">integer</span> :: stiffstatus    </div><div class="line"><span class="keywordtype">real</span>(WP) :: x0, xf    </div><div class="line"><span class="keywordtype">real</span>(WP), <span class="keywordtype">dimension(6)</span> :: y0, yf</div><div class="line"><span class="keywordtype">real</span>(WP), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: EventData <span class="comment">! allocated by Integrate</span></div><div class="line"></div><div class="line">stiffstatus = 1 <span class="comment">! detect stiffness and terminate if equations are stiff    </span></div><div class="line">x0 = 0.0    </div><div class="line">y0 = [6400.0_wp,0.0_wp,0.0_wp, 0.0_wp,7.69202528825512_wp,7.69202528825512_wp]</div><div class="line">xf = 161131.68239305308_wp      </div><div class="line"></div><div class="line"><span class="comment">! Call Tntgerate with final solution in yf, no initial step-size given, events-related</span></div><div class="line"><span class="comment">! data (event-id, x value, y state) in EventData, and all events are detected</span></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="namespaceerk.html">erk</a>%status == flint_success) <span class="keywordflow">then</span>    </div><div class="line">    <span class="keyword">call </span><a class="code" href="namespaceerk.html">erk</a>%Integrate(x0, y0, xf, yf, stepsz=0.0, intstepson=.false.,&amp;</div><div class="line">    eventstates=eventdata, eventmask = [.true.,.true.],stifftest=stiffstatus)</div><div class="line"><span class="keywordflow">end if</span>    </div></div><!-- fragment --><ul>
<li>Call the Interpolate function for computing solution on the desired grid of x values. The last parameter must be specified as True if user wants FLINT to keep the internal storage for calling Interpolate again. Otherwise, the internal storage is deleted and the user must intgerate the equations again before calling Interpolate.</li>
</ul>
<div class="fragment"><div class="line"><span class="keywordtype">real</span>(WP), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: Xarr1, Xarr2</div><div class="line"><span class="keywordtype">real</span>(WP), <span class="keywordtype">dimension(6,:)</span> :: Yarr1, Yarr2</div><div class="line"></div><div class="line">xarr1 = [(x0 + (xf-x0)/10*i, i=0,9)]    <span class="comment">! grid-1 with 10 points</span></div><div class="line">xarr2 = [(x0 + (xf-x0)/1000*i, i=0,999)]    <span class="comment">! grid-2 with 1000 points</span></div><div class="line"><span class="keyword">allocate</span>(yarr1(6,<span class="keyword">size</span>(xarr1)))    <span class="comment">! allocate solution storage</span></div><div class="line"><span class="keyword">allocate</span>(yarr2(6,<span class="keyword">size</span>(xarr2)))        </div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="namespaceerk.html">erk</a>%status == flint_success) <span class="keywordflow">then</span></div><div class="line">  <span class="comment">! interpolate and keep the internal storage for further calls</span></div><div class="line">  <span class="keyword">call </span><a class="code" href="namespaceerk.html">erk</a>%Interpolate(xarr1, yarr1, .true.)</div><div class="line">  <span class="comment">! After this interpolation, delete the internal storage (default).</span></div><div class="line">  <span class="keyword">call </span><a class="code" href="namespaceerk.html">erk</a>%Interpolate(xarr2, yarr2, .false.) </div><div class="line"><span class="keywordflow">end if</span>    </div><div class="line"></div><div class="line"><span class="comment">! print the solutions</span></div><div class="line">print *, <span class="stringliteral">&#39;Solution at grid-1&#39;</span>    </div><div class="line">print *, yarr1</div><div class="line">print *, <span class="stringliteral">&#39;Solution at grid-2&#39;</span>        </div><div class="line">print *, yarr2</div><div class="line"><span class="comment">! print the event data</span></div><div class="line">print *, eventdata(1,:)     <span class="comment">! Time at which events occured</span></div><div class="line">print *, eventdata(2:7,:)   <span class="comment">! corresponding position and velocity states</span></div><div class="line">print *, eventdata(8,:)     ! event-id number</div></div><!-- fragment --><p>For all the FLINT status codes and options supported by Init, Integrate, and Interpolate procedures along with the interfaces for user-supplied functions, see the FLINT_base module in <a class="el" href="_f_l_i_n_t__base_8f90.html">FLINT_base.f90</a> file. </p>
<h1><a class="anchor" id="testsec"></a>
Testing</h1>
<p>In all the tests, the orbit is propagated for 4 orbital periods. The propagation is repeated 5000 times. The tables give the total time for 5000 propagations and all other testing parameters are the values for 1 propagation. The relative tolerance is taken as 1e-11 and absolute tolerance as 1e-14 in all the cases except when explicitly mentioned otherwise. Interpolation is used to capture 1000 points per orbit period, however delayed interpolation feature of FLINT is not used in these results.</p>
<p>The initial conditions in Cartesian coodinates used are as follows:</p><ul>
<li>Two-Body circular Earth orbit (Units: km, sec)<ul>
<li>GM: 398600.436233</li>
<li>Y0 = [6400.0,0.0,0.0, 0.0,5.58037857139,5.58037857139]</li>
</ul>
</li>
<li>Two-Body elliptic Earth orbit (Units: km, sec)<ul>
<li>GM: 398600.436233</li>
<li>Y0 = [6400.0,0.0,0.0,0.0,7.69202528825512,7.69202528825512]</li>
</ul>
</li>
<li>Arenstorf orbit in rotating frame (Units: nondimensional)<ul>
<li>mass-ratio: 0.012277471</li>
<li>time-period: 17.0652165601579625588917206249</li>
<li>Y0 = [0.994, 0.0, 0.0, -2.00158510637908252240537862224]</li>
</ul>
</li>
</ul>
<p>Note that JDOP853 and JDDEABM are modern fortran implementations of DOP853 and DDEABM by Jacob Williams, and are available at <a href="https://github.com/jacobwilliams">https://github.com/jacobwilliams</a>. The plots are generated using <a href="https://github.com/jacobwilliams/pyplot-fortran">https://github.com/jacobwilliams/pyplot-fortran</a>.</p>
<ul>
<li>Two-Body circular Earth orbit <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Params \ Integrator  </th><th class="markdownTableHeadNone">DOP54  </th><th class="markdownTableHeadNone">DOP853  </th><th class="markdownTableHeadNone">Verner65E  </th><th class="markdownTableHeadNone">Verner98R  </th><th class="markdownTableHeadNone">JDOP853  </th><th class="markdownTableHeadNone">JDDEABM   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Closing Error  </td><td class="markdownTableBodyNone">6.3e-6  </td><td class="markdownTableBodyNone">4.3e-7  </td><td class="markdownTableBodyNone">2.7e-6  </td><td class="markdownTableBodyNone">1.1e-7  </td><td class="markdownTableBodyNone">4.3e-7  </td><td class="markdownTableBodyNone">3.1e-6   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IOM Error  </td><td class="markdownTableBodyNone">3.1e-11  </td><td class="markdownTableBodyNone">3.1e-11  </td><td class="markdownTableBodyNone">3.1e-11  </td><td class="markdownTableBodyNone">3.1e-11  </td><td class="markdownTableBodyNone">3.1e-11  </td><td class="markdownTableBodyNone">3.9e-10   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Time (s)  </td><td class="markdownTableBodyNone">2.42  </td><td class="markdownTableBodyNone"><b>0.42</b>  </td><td class="markdownTableBodyNone">1.91  </td><td class="markdownTableBodyNone">0.87  </td><td class="markdownTableBodyNone">1.42  </td><td class="markdownTableBodyNone"><b>0.62</b>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Func Calls  </td><td class="markdownTableBodyNone">7889  </td><td class="markdownTableBodyNone">1886  </td><td class="markdownTableBodyNone">6043  </td><td class="markdownTableBodyNone">2218  </td><td class="markdownTableBodyNone">1886  </td><td class="markdownTableBodyNone">734   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Accepted Steps  </td><td class="markdownTableBodyNone">1302  </td><td class="markdownTableBodyNone">157  </td><td class="markdownTableBodyNone">749  </td><td class="markdownTableBodyNone">131  </td><td class="markdownTableBodyNone">157  </td><td class="markdownTableBodyNone">365   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Rejected Steps  </td><td class="markdownTableBodyNone">15  </td><td class="markdownTableBodyNone">0  </td><td class="markdownTableBodyNone">7  </td><td class="markdownTableBodyNone">8  </td><td class="markdownTableBodyNone">0  </td><td class="markdownTableBodyNone">NA   </td></tr>
</table>
</li>
<li>Two-Body circular Earth orbit with interpolation <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Params \ Integrator  </th><th class="markdownTableHeadNone">DOP54  </th><th class="markdownTableHeadNone">DOP853  </th><th class="markdownTableHeadNone">Verner65E  </th><th class="markdownTableHeadNone">Verner98R  </th><th class="markdownTableHeadNone">JDOP853  </th><th class="markdownTableHeadNone">JDDEABM   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Closing Error  </td><td class="markdownTableBodyNone">6.3e-6  </td><td class="markdownTableBodyNone">4.3e-7  </td><td class="markdownTableBodyNone">2.7e-6  </td><td class="markdownTableBodyNone">1.1e-7  </td><td class="markdownTableBodyNone">4.3e-7  </td><td class="markdownTableBodyNone">3.1e-6   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IOM Error  </td><td class="markdownTableBodyNone">3.1e-11  </td><td class="markdownTableBodyNone">3.1e-11  </td><td class="markdownTableBodyNone">3.1e-11  </td><td class="markdownTableBodyNone">3.1e-11  </td><td class="markdownTableBodyNone">3.1e-11  </td><td class="markdownTableBodyNone">3.9e-10   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Time (s)  </td><td class="markdownTableBodyNone">6.3  </td><td class="markdownTableBodyNone"><b>4.3</b>  </td><td class="markdownTableBodyNone">6.6  </td><td class="markdownTableBodyNone">5.7  </td><td class="markdownTableBodyNone">127.1  </td><td class="markdownTableBodyNone"><b>5.1</b>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Func Calls  </td><td class="markdownTableBodyNone">7889  </td><td class="markdownTableBodyNone">2357  </td><td class="markdownTableBodyNone">6792  </td><td class="markdownTableBodyNone">2873  </td><td class="markdownTableBodyNone">2336  </td><td class="markdownTableBodyNone">734   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Accepted Steps  </td><td class="markdownTableBodyNone">1302  </td><td class="markdownTableBodyNone">157  </td><td class="markdownTableBodyNone">749  </td><td class="markdownTableBodyNone">131  </td><td class="markdownTableBodyNone">157  </td><td class="markdownTableBodyNone">NA   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Rejected Steps  </td><td class="markdownTableBodyNone">15  </td><td class="markdownTableBodyNone">0  </td><td class="markdownTableBodyNone">7  </td><td class="markdownTableBodyNone">8  </td><td class="markdownTableBodyNone">0  </td><td class="markdownTableBodyNone">NA   </td></tr>
</table>
</li>
<li>Two-Body elliptic Earth orbit <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Params \ Integrator  </th><th class="markdownTableHeadNone">DOP54  </th><th class="markdownTableHeadNone">DOP853  </th><th class="markdownTableHeadNone">Verner65E  </th><th class="markdownTableHeadNone">Verner98R  </th><th class="markdownTableHeadNone">JDOP853  </th><th class="markdownTableHeadNone">JDDEABM   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Closing Error  </td><td class="markdownTableBodyNone">2.7  </td><td class="markdownTableBodyNone">2.7  </td><td class="markdownTableBodyNone">2.7  </td><td class="markdownTableBodyNone">2.7  </td><td class="markdownTableBodyNone">2.7  </td><td class="markdownTableBodyNone">2.7   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IOM Error  </td><td class="markdownTableBodyNone">6.7e-10  </td><td class="markdownTableBodyNone">6.7e-10  </td><td class="markdownTableBodyNone">6.7e-10  </td><td class="markdownTableBodyNone">6.7e-10  </td><td class="markdownTableBodyNone">6.7e-10  </td><td class="markdownTableBodyNone">2.3e-9   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Time (s)  </td><td class="markdownTableBodyNone">4.8  </td><td class="markdownTableBodyNone"><b>1.3</b>  </td><td class="markdownTableBodyNone">3.6  </td><td class="markdownTableBodyNone">2.43  </td><td class="markdownTableBodyNone">3.9  </td><td class="markdownTableBodyNone"><b>3.2</b>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Func Calls  </td><td class="markdownTableBodyNone">15409  </td><td class="markdownTableBodyNone">6227  </td><td class="markdownTableBodyNone">11520  </td><td class="markdownTableBodyNone">6223  </td><td class="markdownTableBodyNone">6227  </td><td class="markdownTableBodyNone">3325   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Accepted Steps  </td><td class="markdownTableBodyNone">2552  </td><td class="markdownTableBodyNone">428  </td><td class="markdownTableBodyNone">1431  </td><td class="markdownTableBodyNone">296  </td><td class="markdownTableBodyNone">428  </td><td class="markdownTableBodyNone">1648   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Rejected Steps  </td><td class="markdownTableBodyNone">19  </td><td class="markdownTableBodyNone">99  </td><td class="markdownTableBodyNone">10  </td><td class="markdownTableBodyNone">99  </td><td class="markdownTableBodyNone">99  </td><td class="markdownTableBodyNone">NA   </td></tr>
</table>
</li>
<li>Two-Body elliptic Earth orbit with interpolation <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Params \ Integrator  </th><th class="markdownTableHeadNone">DOP54  </th><th class="markdownTableHeadNone">DOP853  </th><th class="markdownTableHeadNone">Verner65E  </th><th class="markdownTableHeadNone">Verner98R  </th><th class="markdownTableHeadNone">JDOP853  </th><th class="markdownTableHeadNone">JDDEABM   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Closing Error  </td><td class="markdownTableBodyNone">2.7  </td><td class="markdownTableBodyNone">2.7  </td><td class="markdownTableBodyNone">2.7  </td><td class="markdownTableBodyNone">2.7  </td><td class="markdownTableBodyNone">2.7  </td><td class="markdownTableBodyNone">2.7   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IOM Error  </td><td class="markdownTableBodyNone">6.7e-10  </td><td class="markdownTableBodyNone">6.7e-10  </td><td class="markdownTableBodyNone">6.7e-10  </td><td class="markdownTableBodyNone">6.7e-10  </td><td class="markdownTableBodyNone">6.7e-10  </td><td class="markdownTableBodyNone">2.3e-9   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Time (s)  </td><td class="markdownTableBodyNone">10.7  </td><td class="markdownTableBodyNone"><b>6.0</b>  </td><td class="markdownTableBodyNone">10.5  </td><td class="markdownTableBodyNone">8.6  </td><td class="markdownTableBodyNone">130  </td><td class="markdownTableBodyNone"><b>8.3</b>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Func Calls  </td><td class="markdownTableBodyNone">15409  </td><td class="markdownTableBodyNone">7511  </td><td class="markdownTableBodyNone">12951  </td><td class="markdownTableBodyNone">7703  </td><td class="markdownTableBodyNone">7397  </td><td class="markdownTableBodyNone">3325   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Accepted Steps  </td><td class="markdownTableBodyNone">2552  </td><td class="markdownTableBodyNone">428  </td><td class="markdownTableBodyNone">1431  </td><td class="markdownTableBodyNone">296  </td><td class="markdownTableBodyNone">428  </td><td class="markdownTableBodyNone">4000   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Rejected Steps  </td><td class="markdownTableBodyNone">19  </td><td class="markdownTableBodyNone">99  </td><td class="markdownTableBodyNone">10  </td><td class="markdownTableBodyNone">99  </td><td class="markdownTableBodyNone">99  </td><td class="markdownTableBodyNone">NA   </td></tr>
</table>
</li>
<li>Arenstorf orbit <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Params \ Integrator  </th><th class="markdownTableHeadNone">DOP54  </th><th class="markdownTableHeadNone">DOP853  </th><th class="markdownTableHeadNone">Verner65E  </th><th class="markdownTableHeadNone">Verner98R  </th><th class="markdownTableHeadNone">JDOP853  </th><th class="markdownTableHeadNone">JDDEABM   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Closing Error  </td><td class="markdownTableBodyNone">1.7  </td><td class="markdownTableBodyNone">0.33  </td><td class="markdownTableBodyNone">0.33  </td><td class="markdownTableBodyNone">0.31  </td><td class="markdownTableBodyNone">0.33  </td><td class="markdownTableBodyNone">0.23   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IOM Error  </td><td class="markdownTableBodyNone">7.2e-11  </td><td class="markdownTableBodyNone">7.2e-11  </td><td class="markdownTableBodyNone">7.2e-11  </td><td class="markdownTableBodyNone">7.2e-11  </td><td class="markdownTableBodyNone">7.2e-11  </td><td class="markdownTableBodyNone">9.4e-11   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Time (s)  </td><td class="markdownTableBodyNone">14.8  </td><td class="markdownTableBodyNone"><b>3.6</b>  </td><td class="markdownTableBodyNone">10.7  </td><td class="markdownTableBodyNone">6.3  </td><td class="markdownTableBodyNone">12.9  </td><td class="markdownTableBodyNone"><b>7.9</b>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Func Calls  </td><td class="markdownTableBodyNone">44847  </td><td class="markdownTableBodyNone">15816  </td><td class="markdownTableBodyNone">32337  </td><td class="markdownTableBodyNone">15344  </td><td class="markdownTableBodyNone">15816  </td><td class="markdownTableBodyNone">8202   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Accepted Steps  </td><td class="markdownTableBodyNone">7425  </td><td class="markdownTableBodyNone">1074  </td><td class="markdownTableBodyNone">4006  </td><td class="markdownTableBodyNone">792  </td><td class="markdownTableBodyNone">1074  </td><td class="markdownTableBodyNone">4071   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Rejected Steps  </td><td class="markdownTableBodyNone">59  </td><td class="markdownTableBodyNone">266  </td><td class="markdownTableBodyNone">41  </td><td class="markdownTableBodyNone">178  </td><td class="markdownTableBodyNone">266  </td><td class="markdownTableBodyNone">NA   </td></tr>
</table>
</li>
<li>Arenstorf orbit with interpolation <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Params \ Integrator  </th><th class="markdownTableHeadNone">DOP54  </th><th class="markdownTableHeadNone">DOP853  </th><th class="markdownTableHeadNone">Verner65E  </th><th class="markdownTableHeadNone">Verner98R  </th><th class="markdownTableHeadNone">JDOP853  </th><th class="markdownTableHeadNone">JDDEABM   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Closing Error  </td><td class="markdownTableBodyNone">1.7  </td><td class="markdownTableBodyNone">0.33  </td><td class="markdownTableBodyNone">0.33  </td><td class="markdownTableBodyNone">0.31  </td><td class="markdownTableBodyNone">0.33  </td><td class="markdownTableBodyNone">0.23   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IOM Error  </td><td class="markdownTableBodyNone">9.4e-11  </td><td class="markdownTableBodyNone">7.1e-11  </td><td class="markdownTableBodyNone">7.1e-11  </td><td class="markdownTableBodyNone">7.1e-11  </td><td class="markdownTableBodyNone">7.2e-11  </td><td class="markdownTableBodyNone">9.4e-11   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Time (s)  </td><td class="markdownTableBodyNone">29  </td><td class="markdownTableBodyNone"><b>10.8</b>  </td><td class="markdownTableBodyNone">26.4  </td><td class="markdownTableBodyNone">16.4  </td><td class="markdownTableBodyNone">136  </td><td class="markdownTableBodyNone"><b>12.4</b>   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Func Calls  </td><td class="markdownTableBodyNone">44847  </td><td class="markdownTableBodyNone">19038  </td><td class="markdownTableBodyNone">36343  </td><td class="markdownTableBodyNone">19304  </td><td class="markdownTableBodyNone">18315  </td><td class="markdownTableBodyNone">9904   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Accepted Steps  </td><td class="markdownTableBodyNone">7425  </td><td class="markdownTableBodyNone">1074  </td><td class="markdownTableBodyNone">4006  </td><td class="markdownTableBodyNone">792  </td><td class="markdownTableBodyNone">1074  </td><td class="markdownTableBodyNone">4000   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Rejected Steps  </td><td class="markdownTableBodyNone">59  </td><td class="markdownTableBodyNone">266  </td><td class="markdownTableBodyNone">41  </td><td class="markdownTableBodyNone">178  </td><td class="markdownTableBodyNone">266  </td><td class="markdownTableBodyNone">NA   </td></tr>
</table>
</li>
</ul>
<p>For relative tol=1e-9 and abs tol=1e-12, the Arenstorf orbit propagated for 4 periods by JDOP853, JDDEABM and FLINT's Verner98R are shown below. Verner98R diverges much slower than DOP853 and DDEABM for this orbit and tolerance values. </p><div class="image">
<img src="JDOP853.png" alt="JDOP853.png"/>
</div>
 <div class="image">
<img src="Jacob_DDEABM.png" alt="Jacob_DDEABM.png"/>
</div>
 <div class="image">
<img src="FLINT_Verner98R.png" alt="FLINT_Verner98R.png"/>
</div>
   <p>The following figure shows the multiple event detection capability of FLINT, in which the X-crossings in decreasing and Y-crossings in increasing direction are detected and reported to the user. </p><div class="image">
<img src="FLINT_Events.png" alt="FLINT_Events.png"/>
</div>
 <h1><a class="anchor" id="refsec"></a>
References</h1>
<ul>
<li>Hairer, Ernst, Norsett, Syvert P., Wanner, Gerhard, Solving Ordinary Differential Equations I, Springer-Verlag Berlin Heidelberg, 2nd Ed., 1993. </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Jul 23 2019 21:17:41 for FLINT by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
